import { Component, OnInit } from '@angular/core';
import { io } from "socket.io-client";
import * as FileSaver from 'file-saver';
import * as XLSX from 'xlsx';
import { ShareService } from '../../services/shareService';

const EXCEL_TYPE = 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8';
const EXCEL_EXTENSION = '.xlsx';

@Component({
  selector: 'app-mt-articulos',
  templateUrl: './mt-articulos.component.html',
  styleUrls: ['./mt-articulos.component.scss'],
})
export class MtArticulosComponent implements OnInit {
  socket = io('http://38.187.8.22:3200', { query: { code: 'app' } });

  headList = ['Preferencia', 'Codigo Barra', 'Descripcion', 'Departamento', 'Seccion', 'Familia', 'SubFamilia', 'Talla', 'Color', 'BBW JK', 'VS ARQ', 'BBW ARQ', 'BBW RAMB', 'VS RAMB', 'VS PN', 'BBW SM', 'VS SM', 'BBW SLV', 'VS SLV', 'VS MSUR', 'VS PURU', 'VS ECOM', 'BW ECOM', 'VS MGP', 'VS MINKA', 'VSFA JK', 'BBW ASIA'];
  headListTienda = ['Tienda', 'Procesar', 'Procesado', 'Estado'];
  onReporteList: Array<any> = [];

  onDataView: Array<any> = [];
  onListPagination: Array<any> = [];
  vPageActualTable: number = 1;
  vPageAnteriorTable: number = 0;
  vNumPaginas: number = 0;
  isLoading: boolean = false;
  isProccess: boolean = false;
  isError: boolean = false;
  nameExcel: string = "";
  selectedEmail: string = "";
  optionListEmail: Array<any> = [];
  tiendasList: Array<any> = [
    { key: '7A', value: 'BBW JOCKEY', progress: -1, checked: false },
    { key: "9N", value: "VSBA MALL AVENTURA", progress: -1, checked: false },
    { key: "7J", value: "BBW MALL AVENTURA", progress: -1, checked: false },
    { key: '7E', value: 'BBW LA RAMBLA', progress: -1, checked: false },
    { key: '9D', value: 'VS LA RAMBLA', progress: -1, checked: false },
    { key: '9B', value: 'VS PLAZA NORTE', progress: -1, checked: false },
    { key: '7C', value: 'BBW SAN MIGUEL', progress: -1, checked: false },
    { key: '9C', value: 'VS SAN MIGUEL', progress: -1, checked: false },
    { key: '7D', value: 'BBW SALAVERRY', progress: -1, checked: false },
    { key: '9I', value: 'VS SALAVERRY', progress: -1, checked: false },
    { key: '9G', value: 'VS MALL DEL SUR', progress: -1, checked: false },
    { key: '9H', value: 'VS PURUCHUCO', progress: -1, checked: false },
    { key: '9M', value: 'VS ECOMMERCE', progress: -1, checked: false },
    { key: '7F', value: 'BBW ECOMMERCE', progress: -1, checked: false },
    { key: '9K', value: 'VS MEGA PLAZA', progress: -1, checked: false },
    { key: '9L', value: 'VS MINKA', progress: -1, checked: false },
    { key: '9F', value: 'VSFA JOCKEY FULL', progress: -1, checked: false },
    { key: '7A7', value: 'BBW ASIA', progress: -1, checked: false }
  ];

  onListTiendas: Array<any> = [
    { code: '7A', name: 'BBW JOCKEY', procesar: 0, procesado: -1 },
    { code: '9N', name: 'VS MALL AVENTURA', procesar: 0, procesado: -1 },
    { code: '7J', name: 'BBW MALL AVENTURA', procesar: 0, procesado: -1 },
    { code: '7E', name: 'BBW LA RAMBLA', procesar: 0, procesado: -1 },
    { code: '9D', name: 'VS LA RAMBLA', procesar: 0, procesado: -1 },
    { code: '9B', name: 'VS PLAZA NORTE', procesar: 0, procesado: -1 },
    { code: '7C', name: 'BBW SAN MIGUEL', procesar: 0, procesado: -1 },
    { code: '9C', name: 'VS SAN MIGUEL', procesar: 0, procesado: -1 },
    { code: '7D', name: 'BBW SALAVERRY', procesar: 0, procesado: -1 },
    { code: '9I', name: 'VS SALAVERRY', procesar: 0, procesado: -1 },
    { code: '9G', name: 'VS MALL DEL SUR', procesar: 0, procesado: -1 },
    { code: '9H', name: 'VS PURUCHUCO', procesar: 0, procesado: -1 },
    { code: '9M', name: 'VS ECOMMERCE', procesar: 0, procesado: -1 },
    { code: '7F', name: 'BBW ECOMMERCE', procesar: 0, procesado: -1 },
    { code: '9K', name: 'VS MEGA PLAZA', procesar: 0, procesado: -1 },
    { code: '9L', name: 'VS MINKA', procesar: 0, procesado: -1 },
    { code: '9F', name: 'VSFA JOCKEY FULL', procesar: 0, procesado: -1 },
    { code: '7A7', name: 'BBW ASIA', procesar: 0, procesado: -1 }
  ];
  petitionTiendaList: Array<any> = [];

  constructor(private http: ShareService) { }

  ngOnInit() {


    let excel = [
      { code: 26651322 },
      { code: 26651326 },
      { code: 26655522 },
      { code: 26655536 },
      { code: 26655553 },
      { code: 26653985 },
      { code: 26653988 },
      { code: 26653989 },
      { code: 26653992 },
      { code: 26653994 },
      { code: 26653997 },
      { code: 26654137 },
      { code: 26653995 },
      { code: 26654214 },
      { code: 26654215 },
      { code: 26654219 },
      { code: 26654242 },
      { code: 26654243 },
      { code: 26654248 },
      { code: 26654253 },
      { code: 26654222 },
      { code: 26654227 },
      { code: 26653991 },
      { code: 26654252 },
      { code: 26232608 },
      { code: 26232616 },
      { code: 26232636 },
      { code: 26265730 },
      { code: 26265742 },
      { code: 26349356 },
      { code: 26349091 },
      { code: 26350616 },
      { code: 26350617 },
      { code: 26383147 },
      { code: 26383153 },
      { code: 26383850 },
      { code: 26398320 },
      { code: 26440234 },
      { code: 26442233 },
      { code: 26442236 },
      { code: 26442238 },
      { code: 26442241 },
      { code: 26440239 },
      { code: 26440277 },
      { code: 26443107 },
      { code: 26452105 },
      { code: 26452602 },
      { code: 26452702 },
      { code: 26452768 },
      { code: 26452771 },
      { code: 26470004 },
      { code: 26472076 },
      { code: 26472077 },
      { code: 26472078 },
      { code: 26472080 },
      { code: 26472084 },
      { code: 26472087 },
      { code: 26472090 },
      { code: 26472091 },
      { code: 26472092 },
      { code: 26617773 },
      { code: 26617786 },
      { code: 26617787 },
      { code: 26621204 },
      { code: 26618962 },
      { code: 26618977 },
      { code: 26617785 },
      { code: 26651333 },
      { code: 26651329 },
      { code: 26654254 },
      { code: 26654890 },
      { code: 26654897 },
      { code: 26655523 },
      { code: 26655537 },
      { code: 26654871 },
      { code: 26658130 },
      { code: 26676365 },
      { code: 26654848 },
      { code: 26680862 },
      { code: 26680864 },
      { code: 26680866 },
      { code: 26683658 },
      { code: 26683659 },
      { code: 26683660 },
      { code: 26683664 },
      { code: 26683665 },
      { code: 26683667 },
      { code: 26683672 },
      { code: 26683673 },
      { code: 26685833 },
      { code: 26685864 },
      { code: 26685822 },
      { code: 26685832 },
      { code: 26694016 },
      { code: 26694029 },
      { code: 26695446 },
      { code: 26681858 },
      { code: 26681860 },
      { code: 26705378 },
      { code: 26705379 },
      { code: 26703084 },
      { code: 26705308 },
      { code: 26705384 },
      { code: 26705389 },
      { code: 26705902 },
      { code: 26705950 },
      { code: 26705955 },
      { code: 26705984 },
      { code: 26705986 },
      { code: 26705999 },
      { code: 26706013 },
      { code: 26704513 },
      { code: 26706018 },
      { code: 26706022 },
      { code: 26706046 },
      { code: 26683643 },
      { code: 26683644 },
      { code: 26683645 },
      { code: 26683652 },
      { code: 26836875 },
      { code: 26836899 },
      { code: 26842416 },
      { code: 26842443 },
      { code: 26842448 },
      { code: 26842467 },
      { code: 26842481 },
      { code: 26842505 },
      { code: 26842534 },
      { code: 26842546 },
      { code: 26842589 },
      { code: 26842643 },
      { code: 26842672 },
      { code: 26734082 },
      { code: 26728972 },
      { code: 26728980 },
      { code: 26728982 },
      { code: 26731150 },
      { code: 26731160 },
      { code: 26731168 },
      { code: 26731178 },
      { code: 26731179 },
      { code: 26694012 },
      { code: 26697531 },
      { code: 26696941 },
      { code: 26676349 },
      { code: 26676366 },
      { code: 26676355 },
      { code: 26676375 },
      { code: 26676389 },
      { code: 26676367 },
      { code: 26735802 },
      { code: 26735834 },
      { code: 26735889 },
      { code: 26735852 },
      { code: 26735929 },
      { code: 26735933 },
      { code: 26735959 },
      { code: 26735877 },
      { code: 26735940 },
      { code: 26735979 },
      { code: 26735991 },
      { code: 26736904 },
      { code: 26737205 },
      { code: 26737207 },
      { code: 26737212 },
      { code: 26705360 },
      { code: 26705375 },
      { code: 26704525 },
      { code: 26705476 },
      { code: 26705626 },
      { code: 26705710 },
      { code: 26705726 },
      { code: 26705946 },
      { code: 26705903 },
      { code: 26706008 },
      { code: 26706023 },
      { code: 26706034 },
      { code: 26706060 },
      { code: 26706067 },
      { code: 26706079 },
      { code: 26706032 },
      { code: 26705025 },
      { code: 26705031 },
      { code: 26705038 },
      { code: 26705061 },
      { code: 26705063 },
      { code: 26705070 },
      { code: 26705078 },
      { code: 26705080 },
      { code: 26705097 },
      { code: 26705101 },
      { code: 26705133 },
      { code: 26705146 },
      { code: 26705147 },
      { code: 26705155 },
      { code: 26724317 },
      { code: 26743629 },
      { code: 26741975 },
      { code: 26741986 },
      { code: 26741987 },
      { code: 26741988 },
      { code: 26746200 },
      { code: 26746206 },
      { code: 26720470 },
      { code: 26720488 },
      { code: 26657739 },
      { code: 26657741 },
      { code: 26657761 },
      { code: 26657848 },
      { code: 26657861 },
      { code: 26655717 },
      { code: 26704572 },
      { code: 26704574 },
      { code: 26704591 },
      { code: 26704595 },
      { code: 26706213 },
      { code: 26705460 },
      { code: 26706050 },
      { code: 26706055 },
      { code: 26706090 },
      { code: 26706080 },
      { code: 26706084 },
      { code: 26706096 },
      { code: 26706100 },
      { code: 26703389 },
      { code: 26706014 },
      { code: 26704816 },
      { code: 26704528 },
      { code: 26704854 },
      { code: 26706800 },
      { code: 26704864 },
      { code: 26704552 },
      { code: 26704869 },
      { code: 26686124 },
      { code: 26686127 },
      { code: 26686130 },
      { code: 26686131 },
      { code: 26686133 },
      { code: 26686151 },
      { code: 26734014 },
      { code: 26734057 },
      { code: 26734026 },
      { code: 26734035 },
      { code: 26734041 },
      { code: 26734051 },
      { code: 26734052 },
      { code: 26734083 },
      { code: 26734084 },
      { code: 26734093 },
      { code: 26734097 },
      { code: 26734098 },
      { code: 26734099 },
      { code: 26734201 },
      { code: 26734204 },
      { code: 26734206 },
      { code: 26734208 },
      { code: 26734215 },
      { code: 26734223 },
      { code: 26734408 },
      { code: 26734414 },
      { code: 26734422 },
      { code: 26734450 },
      { code: 26734452 },
      { code: 26734404 },
      { code: 26734424 },
      { code: 26734456 },
      { code: 26734472 },
      { code: 26740802 },
      { code: 26740844 },
      { code: 26740830 },
      { code: 26740835 },
      { code: 26741203 },
      { code: 26741207 },
      { code: 26741211 },
      { code: 26741212 },
      { code: 26740865 },
      { code: 26741233 },
      { code: 26741247 },
      { code: 26741257 },
      { code: 26741285 },
      { code: 26741291 },
      { code: 26741312 },
      { code: 26741317 },
      { code: 26788310 },
      { code: 26788321 },
      { code: 26788322 },
      { code: 26788335 },
      { code: 26737077 },
      { code: 26737079 },
      { code: 26737081 },
      { code: 26742645 },
      { code: 26741113 },
      { code: 26742083 },
      { code: 26742040 },
      { code: 26742124 },
      { code: 26732037 },
      { code: 26731187 },
      { code: 26731031 },
      { code: 26737502 },
      { code: 26737509 },
      { code: 26737525 },
      { code: 26737575 },
      { code: 26737587 },
      { code: 26737603 },
      { code: 26736909 },
      { code: 26736910 },
      { code: 26736914 },
      { code: 26737500 },
      { code: 26737505 },
      { code: 26737514 },
      { code: 26736918 },
      { code: 26736919 },
      { code: 26737526 },
      { code: 26737534 },
      { code: 26737537 },
      { code: 26737538 },
      { code: 26737540 },
      { code: 26737563 },
      { code: 26737576 },
      { code: 26737589 },
      { code: 26737592 },
      { code: 26737597 },
      { code: 26737607 },
      { code: 26741235 },
      { code: 26741238 },
      { code: 26741248 },
      { code: 26741252 },
      { code: 26741260 },
      { code: 26740819 },
      { code: 26740821 },
      { code: 26741311 },
      { code: 26741430 },
      { code: 26741281 },
      { code: 26741304 },
      { code: 26741352 },
      { code: 26741361 },
      { code: 26741362 },
      { code: 26741422 },
      { code: 26741426 },
      { code: 26741418 },
      { code: 26740883 },
      { code: 26740895 },
      { code: 26741289 },
      { code: 26741336 },
      { code: 26742046 },
      { code: 26741086 },
      { code: 26742028 },
      { code: 26788159 },
      { code: 26779293 },
      { code: 26788125 },
      { code: 26788144 },
      { code: 26788146 },
      { code: 26788192 },
      { code: 26788316 },
      { code: 26778747 },
      { code: 26778723 },
      { code: 26778725 },
      { code: 26778728 },
      { code: 26778751 },
      { code: 26787830 },
      { code: 26778731 },
      { code: 26778739 },
      { code: 26778750 },
      { code: 26778753 },
      { code: 26786063 },
      { code: 26787864 },
      { code: 26778719 },
      { code: 26787827 },
      { code: 26787873 },
      { code: 26787916 },
      { code: 26777778 },
      { code: 26785737 },
      { code: 26785738 },
      { code: 26785739 },
      { code: 26787121 },
      { code: 26787127 },
      { code: 26787131 },
      { code: 26787135 },
      { code: 26787139 },
      { code: 26785741 },
      { code: 26785742 },
      { code: 26785743 },
      { code: 26785744 },
      { code: 26785746 },
      { code: 26785747 },
      { code: 26785748 },
      { code: 26787142 },
      { code: 26785750 },
      { code: 26785751 },
      { code: 26785752 },
      { code: 26785753 },
      { code: 26785755 },
      { code: 26785757 },
      { code: 26785758 },
      { code: 26785759 },
      { code: 26786087 },
      { code: 26786098 },
      { code: 26786099 },
      { code: 26787820 },
      { code: 26787837 },
      { code: 26787849 },
      { code: 26787859 },
      { code: 26787895 },
      { code: 26787896 },
      { code: 26787900 },
      { code: 26788187 },
      { code: 26788190 },
      { code: 26799962 },
      { code: 26799965 },
      { code: 26799952 },
      { code: 26799964 },
      { code: 26799995 },
      { code: 26802205 },
      { code: 26799960 },
      { code: 26799966 },
      { code: 26799969 },
      { code: 26799975 },
      { code: 26799983 },
      { code: 26799993 },
      { code: 26802202 },
      { code: 26802213 },
      { code: 26799972 },
      { code: 26799973 },
      { code: 26799984 },
      { code: 26799997 },
      { code: 26800800 },
      { code: 26800640 },
      { code: 26800038 },
      { code: 26800047 },
      { code: 26800663 },
      { code: 26800055 },
      { code: 26800070 },
      { code: 26800812 },
      { code: 26800823 },
      { code: 26798860 },
      { code: 26800816 },
      { code: 26793577 },
      { code: 26800755 },
      { code: 26793582 },
      { code: 26793585 },
      { code: 26793591 },
      { code: 26793594 },
      { code: 26800608 },
      { code: 26800671 },
      { code: 26800645 },
      { code: 26800721 },
      { code: 26800725 },
      { code: 26800750 },
      { code: 26798871 },
      { code: 26849159 },
      { code: 26849164 },
      { code: 26849170 },
      { code: 26849166 },
      { code: 26849181 },
      { code: 26835510 },
      { code: 26835535 },
      { code: 26835547 },
      { code: 26835616 },
      { code: 26835619 },
      { code: 26835622 },
      { code: 26897194 },
      { code: 26897197 },
      { code: 26897199 },
      { code: 26892294 },
      { code: 26892298 },
      { code: 26897040 },
      { code: 26897044 },
      { code: 26897054 },
      { code: 26897061 },
      { code: 26897062 },
      { code: 26897073 },
      { code: 26777767 },
      { code: 26777769 },
      { code: 26777770 },
      { code: 26777772 },
      { code: 26777773 },
      { code: 26777777 },
      { code: 26798891 },
      { code: 26801006 },
      { code: 26800022 },
      { code: 26800037 },
      { code: 26800053 },
      { code: 26800619 },
      { code: 26800623 },
      { code: 26848441 },
      { code: 26848444 },
      { code: 26849147 },
      { code: 26849149 },
      { code: 26835502 },
      { code: 26835509 },
      { code: 26835538 },
      { code: 26835559 },
      { code: 26835628 },
      { code: 26835670 },
      { code: 26835689 },
      { code: 26835623 },
      { code: 26835630 },
      { code: 26835652 },
      { code: 26835654 },
      { code: 26835661 },
      { code: 26835669 },
      { code: 26835678 },
      { code: 26835679 },
      { code: 26835697 },
      { code: 26835565 },
      { code: 26835593 },
      { code: 26835540 },
      { code: 26835645 },
      { code: 26835550 },
      { code: 26835554 },
      { code: 26835571 },
      { code: 26835611 },
      { code: 26835636 },
      { code: 26835637 },
      { code: 26835644 },
      { code: 26835651 },
      { code: 26835682 },
      { code: 26835607 },
      { code: 26835612 },
      { code: 26835618 },
      { code: 26835626 },
      { code: 26835683 },
      { code: 26835656 },
      { code: 26835693 },
      { code: 26835699 },
      { code: 26835688 },
      { code: 26835694 },
      { code: 26836303 },
      { code: 26836516 },
      { code: 26836426 },
      { code: 26836436 },
      { code: 26836443 },
      { code: 26836307 },
      { code: 26836308 },
      { code: 26836310 },
      { code: 26836313 },
      { code: 26836314 },
      { code: 26836406 },
      { code: 26836413 },
      { code: 26836414 },
      { code: 26836415 },
      { code: 26836470 },
      { code: 26836316 },
      { code: 26836317 },
      { code: 26836321 },
      { code: 26836323 },
      { code: 26836324 },
      { code: 26836325 },
      { code: 26802204 },
      { code: 26802206 },
      { code: 26799948 },
      { code: 26799951 },
      { code: 26799956 },
      { code: 26799963 },
      { code: 26799976 },
      { code: 26799989 },
      { code: 26799998 },
      { code: 26802203 },
      { code: 26804404 },
      { code: 26804405 },
      { code: 26804410 },
      { code: 26804411 },
      { code: 26804413 },
      { code: 26804414 },
      { code: 26804418 },
      { code: 26804419 },
      { code: 26804421 },
      { code: 26804422 },
      { code: 26804424 },
      { code: 26804426 },
      { code: 26804428 },
      { code: 26804429 },
      { code: 26804430 },
      { code: 26804431 },
      { code: 26804433 },
      { code: 26835534 },
      { code: 26835541 },
      { code: 26814644 },
      { code: 26836416 },
      { code: 26836417 },
      { code: 26836418 },
      { code: 26836444 },
      { code: 26836447 },
      { code: 26836448 },
      { code: 26836451 },
      { code: 26836458 },
      { code: 26836581 },
      { code: 26836515 },
      { code: 26836526 },
      { code: 26836519 },
      { code: 26836514 },
      { code: 26836521 },
      { code: 26836553 },
      { code: 26836543 },
      { code: 26836557 },
      { code: 26836585 },
      { code: 26836598 },
      { code: 26836601 },
      { code: 26836602 },
      { code: 26836605 },
      { code: 26836574 },
      { code: 26836590 },
      { code: 26836588 },
      { code: 26835501 },
      { code: 26835566 },
      { code: 26835569 },
      { code: 26835582 },
      { code: 26836719 },
      { code: 26836731 },
      { code: 26836737 },
      { code: 26836745 },
      { code: 26836762 },
      { code: 26836780 },
      { code: 26836790 },
      { code: 26838404 },
      { code: 26838406 },
      { code: 26838408 },
      { code: 26838409 },
      { code: 26838410 },
      { code: 26838413 },
      { code: 26838271 },
      { code: 26838242 },
      { code: 26842014 },
      { code: 26842017 },
      { code: 26841303 },
      { code: 26841306 },
      { code: 26841311 },
      { code: 26841316 },
      { code: 26842323 },
      { code: 26842335 },
      { code: 26841326 },
      { code: 26841327 },
      { code: 26842042 },
      { code: 26836802 },
      { code: 26836841 },
      { code: 26838602 },
      { code: 26838604 },
      { code: 26838606 },
      { code: 26838236 },
      { code: 26838608 },
      { code: 26838609 },
      { code: 26838611 },
      { code: 26838612 },
      { code: 26838614 },
      { code: 26838615 },
      { code: 26838616 },
      { code: 26838621 },
      { code: 26838622 },
      { code: 26838624 },
      { code: 26838630 },
      { code: 26838634 },
      { code: 26838636 },
      { code: 26838638 },
      { code: 26838639 },
      { code: 26838641 },
      { code: 26838642 },
      { code: 26838644 },
      { code: 26838645 },
      { code: 26838648 },
      { code: 26838652 },
      { code: 26838653 },
      { code: 26838656 },
      { code: 26838658 },
      { code: 26838660 },
      { code: 26759301 },
      { code: 26758441 },
      { code: 26758443 },
      { code: 26810067 },
      { code: 26810071 },
      { code: 26810078 },
      { code: 26810079 },
      { code: 26810080 },
      { code: 26810084 },
      { code: 26810085 },
      { code: 26810086 },
      { code: 26810087 },
      { code: 26810089 },
      { code: 26814627 },
      { code: 26867729 },
      { code: 26861634 },
      { code: 26861635 },
      { code: 26861637 },
      { code: 26861638 },
      { code: 26894394 },
      { code: 26897105 },
      { code: 26897110 },
      { code: 26897126 },
      { code: 26897142 },
      { code: 26897150 },
      { code: 26897151 },
      { code: 26897152 },
      { code: 26897161 },
      { code: 26897167 },
      { code: 26897171 },
      { code: 26897182 },
      { code: 26897187 },
      { code: 26897190 },
      { code: 26897192 },
      { code: 26800200 },
      { code: 26800206 },
      { code: 26800221 },
      { code: 26800232 },
      { code: 26800369 },
      { code: 26797898 },
      { code: 26800223 },
      { code: 26800237 },
      { code: 26800253 },
      { code: 26800259 },
      { code: 26800252 },
      { code: 26800266 },
      { code: 26800269 },
      { code: 26800271 },
      { code: 26800294 },
      { code: 26800298 },
      { code: 26800299 },
      { code: 26800314 },
      { code: 26800322 },
      { code: 26800323 },
      { code: 26800284 },
      { code: 26800288 },
      { code: 26800316 },
      { code: 26800324 },
      { code: 26800336 },
      { code: 26800368 },
      { code: 26800373 },
      { code: 26800377 },
      { code: 26800378 },
      { code: 26800349 },
      { code: 26852036 },
      { code: 26852039 },
      { code: 26852044 },
      { code: 26852045 },
      { code: 26852046 },
      { code: 26852048 },
      { code: 26852049 },
      { code: 26852050 },
      { code: 26852051 },
      { code: 26852052 },
      { code: 26857031 },
      { code: 26857034 },
      { code: 26857040 },
      { code: 26857058 },
      { code: 26857033 },
      { code: 26857035 },
      { code: 26857039 },
      { code: 26857046 },
      { code: 26857047 },
      { code: 26859741 },
      { code: 26859742 },
      { code: 26859743 },
      { code: 26859748 },
      { code: 26857052 },
      { code: 26857059 },
      { code: 26857072 },
      { code: 26857080 },
      { code: 26857083 },
      { code: 26857061 },
      { code: 26857067 },
      { code: 26857077 },
      { code: 26857093 },
      { code: 26857096 },
      { code: 26864312 },
      { code: 26857082 },
      { code: 26857086 },
      { code: 26857097 },
      { code: 26857098 },
      { code: 26864301 },
      { code: 26864313 },
      { code: 26864314 },
      { code: 26920778 },
      { code: 26917839 },
      { code: 26917845 },
      { code: 26920780 },

    ];

    let bd = [
      { code: 24538681 },
      { code: 24541536 },
      { code: 24558817 },
      { code: 24566837 },
      { code: 26232608 },
      { code: 26232616 },
      { code: 26232636 },
      { code: 26265730 },
      { code: 26265742 },
      { code: 26349091 },
      { code: 26349356 },
      { code: 26350616 },
      { code: 26350617 },
      { code: 26383147 },
      { code: 26383153 },
      { code: 26383850 },
      { code: 26398320 },
      { code: 26440234 },
      { code: 26440239 },
      { code: 26440277 },
      { code: 26442233 },
      { code: 26442236 },
      { code: 26442238 },
      { code: 26442241 },
      { code: 26443107 },
      { code: 26452105 },
      { code: 26452602 },
      { code: 26452702 },
      { code: 26452768 },
      { code: 26452771 },
      { code: 26470004 },
      { code: 26472076 },
      { code: 26472077 },
      { code: 26472078 },
      { code: 26472080 },
      { code: 26472084 },
      { code: 26472087 },
      { code: 26472090 },
      { code: 26472091 },
      { code: 26472092 },
      { code: 26617773 },
      { code: 26617785 },
      { code: 26617786 },
      { code: 26617787 },
      { code: 26618962 },
      { code: 26618977 },
      { code: 26621204 },
      { code: 26651322 },
      { code: 26651326 },
      { code: 26651329 },
      { code: 26651333 },
      { code: 26653985 },
      { code: 26653988 },
      { code: 26653989 },
      { code: 26653991 },
      { code: 26653992 },
      { code: 26653994 },
      { code: 26653995 },
      { code: 26653997 },
      { code: 26654137 },
      { code: 26654214 },
      { code: 26654215 },
      { code: 26654219 },
      { code: 26654222 },
      { code: 26654227 },
      { code: 26654242 },
      { code: 26654243 },
      { code: 26654248 },
      { code: 26654252 },
      { code: 26654253 },
      { code: 26654254 },
      { code: 26654848 },
      { code: 26654871 },
      { code: 26654890 },
      { code: 26654897 },
      { code: 26655522 },
      { code: 26655523 },
      { code: 26655536 },
      { code: 26655537 },
      { code: 26655553 },
      { code: 26655717 },
      { code: 26657739 },
      { code: 26657741 },
      { code: 26657761 },
      { code: 26657848 },
      { code: 26657861 },
      { code: 26658130 },
      { code: 26676349 },
      { code: 26676355 },
      { code: 26676365 },
      { code: 26676366 },
      { code: 26676367 },
      { code: 26676375 },
      { code: 26676389 },
      { code: 26680862 },
      { code: 26680864 },
      { code: 26680866 },
      { code: 26681858 },
      { code: 26681860 },
      { code: 26683643 },
      { code: 26683644 },
      { code: 26683645 },
      { code: 26683652 },
      { code: 26683658 },
      { code: 26683659 },
      { code: 26683660 },
      { code: 26683664 },
      { code: 26683665 },
      { code: 26683667 },
      { code: 26683672 },
      { code: 26683673 },
      { code: 26685822 },
      { code: 26685832 },
      { code: 26685833 },
      { code: 26685864 },
      { code: 26686124 },
      { code: 26686127 },
      { code: 26686130 },
      { code: 26686131 },
      { code: 26686133 },
      { code: 26686151 },
      { code: 26694012 },
      { code: 26694016 },
      { code: 26694029 },
      { code: 26696941 },
      { code: 26697531 },
      { code: 26703084 },
      { code: 26703389 },
      { code: 26704513 },
      { code: 26704525 },
      { code: 26704528 },
      { code: 26704552 },
      { code: 26704572 },
      { code: 26704574 },
      { code: 26704591 },
      { code: 26704595 },
      { code: 26704816 },
      { code: 26704854 },
      { code: 26704864 },
      { code: 26704869 },
      { code: 26705025 },
      { code: 26705031 },
      { code: 26705038 },
      { code: 26705061 },
      { code: 26705063 },
      { code: 26705070 },
      { code: 26705078 },
      { code: 26705080 },
      { code: 26705097 },
      { code: 26705101 },
      { code: 26705133 },
      { code: 26705146 },
      { code: 26705147 },
      { code: 26705155 },
      { code: 26705308 },
      { code: 26705360 },
      { code: 26705375 },
      { code: 26705378 },
      { code: 26705379 },
      { code: 26705384 },
      { code: 26705389 },
      { code: 26705460 },
      { code: 26705476 },
      { code: 26705626 },
      { code: 26705710 },
      { code: 26705726 },
      { code: 26705902 },
      { code: 26705903 },
      { code: 26705946 },
      { code: 26705950 },
      { code: 26705955 },
      { code: 26705984 },
      { code: 26705986 },
      { code: 26705999 },
      { code: 26706008 },
      { code: 26706013 },
      { code: 26706014 },
      { code: 26706018 },
      { code: 26706022 },
      { code: 26706023 },
      { code: 26706032 },
      { code: 26706034 },
      { code: 26706046 },
      { code: 26706050 },
      { code: 26706055 },
      { code: 26706060 },
      { code: 26706067 },
      { code: 26706079 },
      { code: 26706080 },
      { code: 26706084 },
      { code: 26706090 },
      { code: 26706096 },
      { code: 26706100 },
      { code: 26706213 },
      { code: 26706800 },
      { code: 26720470 },
      { code: 26720488 },
      { code: 26724317 },
      { code: 26728972 },
      { code: 26728980 },
      { code: 26728982 },
      { code: 26731031 },
      { code: 26731150 },
      { code: 26731160 },
      { code: 26731168 },
      { code: 26731178 },
      { code: 26731179 },
      { code: 26731187 },
      { code: 26732037 },
      { code: 26734014 },
      { code: 26734026 },
      { code: 26734035 },
      { code: 26734041 },
      { code: 26734051 },
      { code: 26734052 },
      { code: 26734082 },
      { code: 26734083 },
      { code: 26734084 },
      { code: 26734093 },
      { code: 26734097 },
      { code: 26734098 },
      { code: 26734099 },
      { code: 26734201 },
      { code: 26734204 },
      { code: 26734206 },
      { code: 26734208 },
      { code: 26734215 },
      { code: 26734223 },
      { code: 26734404 },
      { code: 26734408 },
      { code: 26734414 },
      { code: 26734422 },
      { code: 26734424 },
      { code: 26734450 },
      { code: 26734452 },
      { code: 26734456 },
      { code: 26734472 },
      { code: 26735802 },
      { code: 26735852 },
      { code: 26735877 },
      { code: 26735889 },
      { code: 26735929 },
      { code: 26735940 },
      { code: 26735959 },
      { code: 26735979 },
      { code: 26735991 },
      { code: 26736904 },
      { code: 26736909 },
      { code: 26736910 },
      { code: 26736914 },
      { code: 26736918 },
      { code: 26736919 },
      { code: 26737077 },
      { code: 26737079 },
      { code: 26737081 },
      { code: 26737205 },
      { code: 26737207 },
      { code: 26737212 },
      { code: 26737500 },
      { code: 26737502 },
      { code: 26737505 },
      { code: 26737509 },
      { code: 26737514 },
      { code: 26737525 },
      { code: 26737526 },
      { code: 26737534 },
      { code: 26737537 },
      { code: 26737538 },
      { code: 26737540 },
      { code: 26737563 },
      { code: 26737575 },
      { code: 26737576 },
      { code: 26737587 },
      { code: 26737589 },
      { code: 26737592 },
      { code: 26737597 },
      { code: 26737603 },
      { code: 26737607 },
      { code: 26740802 },
      { code: 26740835 },
      { code: 26740844 },
      { code: 26740865 },
      { code: 26740883 },
      { code: 26740895 },
      { code: 26741086 },
      { code: 26741113 },
      { code: 26741203 },
      { code: 26741207 },
      { code: 26741211 },
      { code: 26741212 },
      { code: 26741233 },
      { code: 26741235 },
      { code: 26741238 },
      { code: 26741247 },
      { code: 26741248 },
      { code: 26741252 },
      { code: 26741257 },
      { code: 26741260 },
      { code: 26741281 },
      { code: 26741285 },
      { code: 26741289 },
      { code: 26741291 },
      { code: 26741304 },
      { code: 26741311 },
      { code: 26741312 },
      { code: 26741317 },
      { code: 26741336 },
      { code: 26741352 },
      { code: 26741361 },
      { code: 26741362 },
      { code: 26741418 },
      { code: 26741422 },
      { code: 26741426 },
      { code: 26741430 },
      { code: 26741975 },
      { code: 26741986 },
      { code: 26741987 },
      { code: 26741988 },
      { code: 26742028 },
      { code: 26742040 },
      { code: 26742046 },
      { code: 26742083 },
      { code: 26742124 },
      { code: 26742645 },
      { code: 26743629 },
      { code: 26746200 },
      { code: 26746206 },
      { code: 26758441 },
      { code: 26758443 },
      { code: 26759301 },
      { code: 26777767 },
      { code: 26777769 },
      { code: 26777770 },
      { code: 26777772 },
      { code: 26777773 },
      { code: 26777778 },
      { code: 26778719 },
      { code: 26778723 },
      { code: 26778725 },
      { code: 26778728 },
      { code: 26778731 },
      { code: 26778739 },
      { code: 26778747 },
      { code: 26778750 },
      { code: 26778751 },
      { code: 26778753 },
      { code: 26779293 },
      { code: 26785737 },
      { code: 26785738 },
      { code: 26785739 },
      { code: 26785741 },
      { code: 26785742 },
      { code: 26785743 },
      { code: 26785744 },
      { code: 26785746 },
      { code: 26785747 },
      { code: 26785748 },
      { code: 26785750 },
      { code: 26785751 },
      { code: 26785752 },
      { code: 26785753 },
      { code: 26785755 },
      { code: 26785757 },
      { code: 26785758 },
      { code: 26785759 },
      { code: 26786063 },
      { code: 26786087 },
      { code: 26786098 },
      { code: 26786099 },
      { code: 26787121 },
      { code: 26787127 },
      { code: 26787131 },
      { code: 26787135 },
      { code: 26787139 },
      { code: 26787142 },
      { code: 26787820 },
      { code: 26787827 },
      { code: 26787830 },
      { code: 26787837 },
      { code: 26787849 },
      { code: 26787859 },
      { code: 26787864 },
      { code: 26787873 },
      { code: 26787895 },
      { code: 26787896 },
      { code: 26787900 },
      { code: 26787916 },
      { code: 26788125 },
      { code: 26788144 },
      { code: 26788146 },
      { code: 26788159 },
      { code: 26788187 },
      { code: 26788190 },
      { code: 26788192 },
      { code: 26788310 },
      { code: 26788316 },
      { code: 26788321 },
      { code: 26788322 },
      { code: 26788335 },
      { code: 26793577 },
      { code: 26793582 },
      { code: 26793585 },
      { code: 26793591 },
      { code: 26793594 },
      { code: 26797898 },
      { code: 26798860 },
      { code: 26798871 },
      { code: 26798891 },
      { code: 26799948 },
      { code: 26799951 },
      { code: 26799952 },
      { code: 26799956 },
      { code: 26799960 },
      { code: 26799962 },
      { code: 26799963 },
      { code: 26799964 },
      { code: 26799965 },
      { code: 26799966 },
      { code: 26799969 },
      { code: 26799972 },
      { code: 26799973 },
      { code: 26799975 },
      { code: 26799976 },
      { code: 26799983 },
      { code: 26799984 },
      { code: 26799989 },
      { code: 26799993 },
      { code: 26799995 },
      { code: 26799997 },
      { code: 26799998 },
      { code: 26800022 },
      { code: 26800037 },
      { code: 26800038 },
      { code: 26800047 },
      { code: 26800053 },
      { code: 26800055 },
      { code: 26800070 },
      { code: 26800200 },
      { code: 26800206 },
      { code: 26800221 },
      { code: 26800223 },
      { code: 26800232 },
      { code: 26800237 },
      { code: 26800252 },
      { code: 26800253 },
      { code: 26800259 },
      { code: 26800266 },
      { code: 26800269 },
      { code: 26800271 },
      { code: 26800284 },
      { code: 26800288 },
      { code: 26800294 },
      { code: 26800298 },
      { code: 26800299 },
      { code: 26800314 },
      { code: 26800316 },
      { code: 26800322 },
      { code: 26800323 },
      { code: 26800324 },
      { code: 26800336 },
      { code: 26800349 },
      { code: 26800368 },
      { code: 26800369 },
      { code: 26800373 },
      { code: 26800377 },
      { code: 26800378 },
      { code: 26800608 },
      { code: 26800619 },
      { code: 26800623 },
      { code: 26800640 },
      { code: 26800645 },
      { code: 26800663 },
      { code: 26800671 },
      { code: 26800721 },
      { code: 26800725 },
      { code: 26800750 },
      { code: 26800755 },
      { code: 26800800 },
      { code: 26800812 },
      { code: 26800816 },
      { code: 26800823 },
      { code: 26801006 },
      { code: 26802202 },
      { code: 26802203 },
      { code: 26802204 },
      { code: 26802205 },
      { code: 26802206 },
      { code: 26802213 },
      { code: 26804404 },
      { code: 26804405 },
      { code: 26804410 },
      { code: 26804411 },
      { code: 26804413 },
      { code: 26804414 },
      { code: 26804418 },
      { code: 26804419 },
      { code: 26804421 },
      { code: 26804422 },
      { code: 26804424 },
      { code: 26804426 },
      { code: 26804428 },
      { code: 26804429 },
      { code: 26804430 },
      { code: 26804431 },
      { code: 26804433 },
      { code: 26810067 },
      { code: 26810071 },
      { code: 26810078 },
      { code: 26810079 },
      { code: 26810080 },
      { code: 26810084 },
      { code: 26810085 },
      { code: 26810086 },
      { code: 26810087 },
      { code: 26810089 },
      { code: 26814627 },
      { code: 26814644 },
      { code: 26835501 },
      { code: 26835502 },
      { code: 26835509 },
      { code: 26835510 },
      { code: 26835534 },
      { code: 26835535 },
      { code: 26835538 },
      { code: 26835540 },
      { code: 26835541 },
      { code: 26835547 },
      { code: 26835550 },
      { code: 26835554 },
      { code: 26835559 },
      { code: 26835565 },
      { code: 26835566 },
      { code: 26835569 },
      { code: 26835571 },
      { code: 26835582 },
      { code: 26835593 },
      { code: 26835607 },
      { code: 26835611 },
      { code: 26835612 },
      { code: 26835616 },
      { code: 26835618 },
      { code: 26835619 },
      { code: 26835622 },
      { code: 26835623 },
      { code: 26835626 },
      { code: 26835628 },
      { code: 26835630 },
      { code: 26835636 },
      { code: 26835637 },
      { code: 26835644 },
      { code: 26835645 },
      { code: 26835651 },
      { code: 26835652 },
      { code: 26835654 },
      { code: 26835656 },
      { code: 26835661 },
      { code: 26835669 },
      { code: 26835670 },
      { code: 26835678 },
      { code: 26835679 },
      { code: 26835682 },
      { code: 26835683 },
      { code: 26835688 },
      { code: 26835689 },
      { code: 26835693 },
      { code: 26835694 },
      { code: 26835697 },
      { code: 26835699 },
      { code: 26836303 },
      { code: 26836307 },
      { code: 26836308 },
      { code: 26836310 },
      { code: 26836313 },
      { code: 26836314 },
      { code: 26836316 },
      { code: 26836317 },
      { code: 26836321 },
      { code: 26836323 },
      { code: 26836324 },
      { code: 26836325 },
      { code: 26836406 },
      { code: 26836413 },
      { code: 26836414 },
      { code: 26836415 },
      { code: 26836416 },
      { code: 26836417 },
      { code: 26836418 },
      { code: 26836426 },
      { code: 26836436 },
      { code: 26836443 },
      { code: 26836444 },
      { code: 26836447 },
      { code: 26836448 },
      { code: 26836451 },
      { code: 26836458 },
      { code: 26836470 },
      { code: 26836514 },
      { code: 26836515 },
      { code: 26836516 },
      { code: 26836519 },
      { code: 26836521 },
      { code: 26836526 },
      { code: 26836543 },
      { code: 26836553 },
      { code: 26836557 },
      { code: 26836574 },
      { code: 26836581 },
      { code: 26836585 },
      { code: 26836588 },
      { code: 26836590 },
      { code: 26836598 },
      { code: 26836601 },
      { code: 26836602 },
      { code: 26836605 },
      { code: 26836719 },
      { code: 26836731 },
      { code: 26836737 },
      { code: 26836745 },
      { code: 26836762 },
      { code: 26836780 },
      { code: 26836790 },
      { code: 26836802 },
      { code: 26836841 },
      { code: 26836875 },
      { code: 26836899 },
      { code: 26838236 },
      { code: 26838242 },
      { code: 26838271 },
      { code: 26838404 },
      { code: 26838406 },
      { code: 26838408 },
      { code: 26838409 },
      { code: 26838410 },
      { code: 26838413 },
      { code: 26838602 },
      { code: 26838604 },
      { code: 26838606 },
      { code: 26838608 },
      { code: 26838609 },
      { code: 26838611 },
      { code: 26838612 },
      { code: 26838614 },
      { code: 26838615 },
      { code: 26838616 },
      { code: 26838621 },
      { code: 26838622 },
      { code: 26838624 },
      { code: 26838630 },
      { code: 26838634 },
      { code: 26838636 },
      { code: 26838638 },
      { code: 26838639 },
      { code: 26838641 },
      { code: 26838642 },
      { code: 26838644 },
      { code: 26838645 },
      { code: 26838648 },
      { code: 26838652 },
      { code: 26838653 },
      { code: 26838656 },
      { code: 26838658 },
      { code: 26838660 },
      { code: 26841303 },
      { code: 26841306 },
      { code: 26841311 },
      { code: 26841316 },
      { code: 26841326 },
      { code: 26841327 },
      { code: 26842014 },
      { code: 26842017 },
      { code: 26842042 },
      { code: 26842323 },
      { code: 26842335 },
      { code: 26842416 },
      { code: 26842443 },
      { code: 26842448 },
      { code: 26842467 },
      { code: 26842481 },
      { code: 26842505 },
      { code: 26842534 },
      { code: 26842546 },
      { code: 26842589 },
      { code: 26842643 },
      { code: 26842672 },
      { code: 26848441 },
      { code: 26848444 },
      { code: 26849147 },
      { code: 26849149 },
      { code: 26849159 },
      { code: 26849164 },
      { code: 26849166 },
      { code: 26849170 },
      { code: 26849181 },
      { code: 26852036 },
      { code: 26852039 },
      { code: 26852044 },
      { code: 26852045 },
      { code: 26852046 },
      { code: 26852048 },
      { code: 26852049 },
      { code: 26852050 },
      { code: 26852051 },
      { code: 26852052 },
      { code: 26857031 },
      { code: 26857033 },
      { code: 26857034 },
      { code: 26857035 },
      { code: 26857039 },
      { code: 26857040 },
      { code: 26857046 },
      { code: 26857047 },
      { code: 26857052 },
      { code: 26857058 },
      { code: 26857059 },
      { code: 26857061 },
      { code: 26857067 },
      { code: 26857072 },
      { code: 26857077 },
      { code: 26857080 },
      { code: 26857082 },
      { code: 26857083 },
      { code: 26857086 },
      { code: 26857093 },
      { code: 26857096 },
      { code: 26857097 },
      { code: 26857098 },
      { code: 26859741 },
      { code: 26859742 },
      { code: 26859743 },
      { code: 26859748 },
      { code: 26861634 },
      { code: 26861635 },
      { code: 26861637 },
      { code: 26861638 },
      { code: 26864301 },
      { code: 26864312 },
      { code: 26864313 },
      { code: 26864314 },
      { code: 26867729 },
      { code: 26892294 },
      { code: 26892298 },
      { code: 26894394 },
      { code: 26897040 },
      { code: 26897044 },
      { code: 26897054 },
      { code: 26897061 },
      { code: 26897062 },
      { code: 26897073 },
      { code: 26897105 },
      { code: 26897110 },
      { code: 26897126 },
      { code: 26897142 },
      { code: 26897150 },
      { code: 26897151 },
      { code: 26897152 },
      { code: 26897161 },
      { code: 26897167 },
      { code: 26897171 },
      { code: 26897182 },
      { code: 26897187 },
      { code: 26897190 },
      { code: 26897192 },
      { code: 26897194 },
      { code: 26897197 },
      { code: 26897199 },
      { code: 26917839 },
      { code: 26917845 },
      { code: 26920778 },
      { code: 26920780 },

    ]

    let exist = [];

    excel.filter((exc) => {
      let a = bd.find((b) => b.code == exc.code);
      
      if (typeof a == 'undefined') {
        let b = exist.find((c) => c.code == exc.code);
        if (typeof a == 'undefined') {
          exist.push(exc);
          console.log(exist);
        }
      }

    });

    








    this.onReporteList = this.onReporteList;

    this.onPaginator();
    this.onViewDataTable(this.vPageAnteriorTable, this.vPageActualTable);

    this.socket.on('dataStock', (dataInventario) => {
      let dataParse = JSON.parse(dataInventario);
      let codigoTienda = (dataParse || {}).code;
      let tiendaIndex = this.tiendasList.findIndex((property) => (property || {}).key == codigoTienda);
      (this.tiendasList[tiendaIndex] || {})['progress'] = (dataParse || {}).progress == 100 ? 0 : (dataParse || {}).progress;
    });

    let parms = {
      url: '/security/emailList'
    };

    return this.http.get(parms).then((response) => {
      let data = response || [];
      data.filter((list) => {
        this.optionListEmail.push({
          key: list.mail,
          value: list.mail
        });
      });

      console.log(this.optionListEmail);
    });
  }

  onViewDataTable(pageAnt, pageAct) {
    const self = this;
    self.onDataView = [];
    if (this.onReporteList.length < 10) {
      this.onDataView = this.onReporteList;
    } else {
      (this.onReporteList || []).filter((data, i) => {
        if (pageAct > 1) {
          if (i > (pageAnt * 10 - 1) && i <= (pageAct * 10 - 1)) {
            self.onDataView.push(data);
          }
        } else {
          if (i <= (pageAct * 10 - 1)) {
            self.onDataView.push(data);
          }
        }
      });
    }

    self.vPageAnteriorTable = pageAnt;
    self.vPageActualTable = pageAct;
    self.isProccess = false;
  }

  onViewPrevius() {
    this.onViewDataTable(this.vPageAnteriorTable - 1, this.vPageActualTable - 1);
  }

  onViewNext() {
    this.onViewDataTable(this.vPageAnteriorTable + 1, this.vPageActualTable + 1);
  }

  onPaginator() {
    this.onListPagination = [];

    if (this.onReporteList.length >= 5) {
      for (let i = 1; i <= Math.round(this.onReporteList.length / 10); i++) {
        this.onListPagination.push({
          pAnterior: i - 1,
          pActual: i
        });
      }
    } else {
      this.onListPagination.push({
        pAnterior: 0,
        pActual: 1
      });
    }

  }

  onExcelExport() {
    const self = this;
    self.isLoading = true;
    this.exportAsExcelFile(this.onReporteList, self.nameExcel);
  }

  public exportAsExcelFile(json: any[], excelFileName: string): void {
    const self = this;
    const worksheet: XLSX.WorkSheet = XLSX.utils.json_to_sheet(json);
    const workbook: XLSX.WorkBook = { Sheets: { 'data': worksheet }, SheetNames: ['data'] };
    const excelBuffer: any = XLSX.write(workbook, { bookType: 'xlsx', type: 'buffer' });
    this.saveAsExcelFile(excelBuffer, excelFileName);
    self.isLoading = false;
  }

  private saveAsExcelFile(buffer: any, fileName: string): void {
    const data: Blob = new Blob([buffer], {
      type: EXCEL_TYPE
    });
    FileSaver.saveAs(data, fileName + '_export_' + new Date().getTime() + EXCEL_EXTENSION);
  }

  onCargaInventario() {
    const self = this;
    if (this.selectedEmail.length) {
      self.isLoading = true;
      this.socket.emit('comunicationStock', this.selectedEmail, this.petitionTiendaList);
    } else {
      this.isError = true;
    }
  }

  onCheked(ev, code) {
    let isChecked = ev.target.checked;

    if (code != 'all') {
      let index = this.petitionTiendaList.findIndex((tienda) => tienda.code == code);

      if (isChecked && index == -1) {
        this.petitionTiendaList.push({
          code: code
        });
      } else {
        this.petitionTiendaList.splice(index, 1);
      }
    } else {
      this.tiendasList.forEach(x => x.checked = isChecked);
      if (this.petitionTiendaList.length != 18) {
        this.petitionTiendaList = [];
        this.tiendasList.filter((tn) => {
          this.petitionTiendaList.push({
            code: tn.key
          });
        });
      } else {
        this.petitionTiendaList = [];
      }
    }


  }

  onProcessData(dataInventario) {
    return new Promise((resolve, reject) => {
      const self = this;
      let codigoTienda = (dataInventario || [])[0].cCodigoTienda;

      //let dataResponse = [];
      let dataProcess = [];
      let dataServer = dataInventario;

      let tiendasList = [
        { code: '7A', property: 'bbw_jockey', ready: false },
        { code: '9N', property: 'vs_m_aventura', ready: false },
        { code: '7J', property: 'bbw_m_aventura', ready: false },
        { code: '7E', property: 'bbw_rambla', ready: false },
        { code: '9D', property: 'vs_rambla', ready: false },
        { code: '9B', property: 'vs_p_norte', ready: false },
        { code: '7C', property: 'bbw_s_miguel', ready: false },
        { code: '9C', property: 'vs_s_miguel', ready: false },
        { code: '7D', property: 'bbw_salaverry', ready: false },
        { code: '9I', property: 'vs_salaverry', ready: false },
        { code: '9G', property: 'vs_m_sur', ready: false },
        { code: '9H', property: 'vs_puruchuco', ready: false },
        { code: '9M', property: 'vs_ecom', ready: false },
        { code: '7F', property: 'bbw_ecom', ready: false },
        { code: '9K', property: 'vs_m_plaza', ready: false },
        { code: '9L', property: 'vs_minka', ready: false },
        { code: '9F', property: 'vs_full', ready: false },
        { code: '7A7', property: 'bbw_asia', ready: false }
      ];

      /*   let tiendaIndex = tiendasList.findIndex((property) => (property || {}).code == codigoTienda);
         tiendasList[tiendaIndex]['ready'] = true;
   
         let countReady = 0;
   
         tiendasList.filter((tienda) => {
           if ((tienda || {}).ready == true) {
             countReady += 1;
           }
         });*/

      // if (countReady == 1) {

      dataProcess = dataServer;
      let indexTienda = tiendasList.findIndex((property) => (property || {}).code == codigoTienda);
      self.onListTiendas[indexTienda]['procesar'] = dataInventario.length;

      (dataProcess || []).filter((data, i) => {

        let index = self.onReporteList.findIndex((res) => ((res || {}).cCodigoBarra == (data || {}).cCodigoBarra) && ((res || {}).cFamilia == (data || {}).cFamilia));

        if (index != -1) {
          let codigoExist = (data || {}).cCodigoTienda;
          let valueSock = tiendasList.find((property) => (property || {}).code == codigoExist);
          let stockProducto = typeof (data || {}).cStock != 'undefined' ? (data || {})[(valueSock || {}).property] : 0;
          //let index = self.onReporteList.findIndex((dataIndex) => ((dataIndex || {}).cCodigoBarra == (data || {}).cCodigoBarra) && ((dataIndex || {}).cFamilia == (data || {}).cFamilia));
          self.onReporteList[index][(valueSock || {}).property] = stockProducto + self.onReporteList[index][(valueSock || {}).property];

        } else {
          self.onReporteList.push(data);
        }
        self.onListTiendas[indexTienda]['procesado'] = i + 1;

      });

      this.onPaginator();
      this.onViewDataTable(this.vPageAnteriorTable, this.vPageActualTable);

      resolve(true);
      // }
    });
  }

  async onChangeSelect(data: any) {
    let selectData = data || {};
    let index = (selectData || {}).selectId || "";
    this[index] = (selectData || {}).key || "";
    this.isError = false;
  }

}


